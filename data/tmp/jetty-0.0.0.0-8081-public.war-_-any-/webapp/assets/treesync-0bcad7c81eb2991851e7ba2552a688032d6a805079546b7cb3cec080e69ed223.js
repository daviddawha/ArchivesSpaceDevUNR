!function(t,e,o){"$:nomunge";function r(t){return t=t||location.href,"#"+t.replace(/^[^#]*#?(.*)$/,"$1")}var n,i="hashchange",a=document,l=t.event.special,s=a.documentMode,d="on"+i in e&&(s===o||s>7);t.fn[i]=function(t){return t?this.bind(i,t):this.trigger(i)},t.fn[i].delay=50,l[i]=t.extend(l[i],{setup:function(){return!d&&void t(n.start)},teardown:function(){return!d&&void t(n.stop)}}),n=function(){function n(){var o=r(),l=c(s);o!==s?(p(s=o,l),t(e).trigger(i)):l!==s&&(location.href=location.href.replace(/#.*/,"")+l),a=setTimeout(n,t.fn[i].delay)}var a,l={},s=r(),d=function(t){return t},p=d,c=d;return l.start=function(){a||n()},l.stop=function(){a&&clearTimeout(a),a=o},l}()}(jQuery,this),function(t){function e(t){this.repo_id=t}e.prototype.treeIsReady=function(t){this.tree=t,void 0!=this.scroller&&this.ready()},e.prototype.infiniteScrollIsReady=function(t){this.scroller=t,void 0!=this.tree&&this.ready()},e.prototype.ready=function(){var t=this;t.setupHashChange(),t.scroller.registerScrollCallback($.proxy(t.handleScroll,this));var e=t.tree_id_from_hash();null!=e&&t.tree.setCurrentNode(e,function(){t.tree.elt.scrollTo("#"+e,0,{offset:-50})})},e.prototype.setupHashChange=function(){$(window).hashchange($.proxy(this.handleHashChange,this)),this.handleHashChange()},e.prototype.handleHashChange=function(){var t=this.tree_id_from_hash();return null!=t&&void this.scrollTo(t)},e.prototype.tree_id_from_hash=function(){if(location.hash){var t=location.hash.replace(/^#(tree::)?/,"");return TreeIds.parse_tree_id(t)?t:null}},e.prototype.scrollTo=function(t){var e=this,o=e.uriForTreeId(t),r=e.scroller.wrapper.find('[data-uris*="'+o+';"], [data-uris$="'+o+'"]'),n=r.data("uris").split(";"),i=$.inArray(o,n),a=r.data("waypointNumber"),l=r.data("waypointSize"),s=a*l+i;r.is(".populated")?e.scroller.scrollToRecord(s):e.scroller.populateWaypoints(r,!1,function(){e.scroller.scrollToRecord(s)})},e.prototype.SCROLL_TIMEOUT=500,e.prototype.handleScroll=function(){var t=this,e=function(){var e=t.scroller.getClosestElement(),o=e.data("uri"),r=TreeIds.uri_to_tree_id(o);t.tree.setCurrentNode(r,function(){t.tree.elt.scrollTo("#"+r,0,{offset:-50})})};clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(function(){e()},this.SCROLL_TIMEOUT)},e.prototype.uriForTreeId=function(t){var e=TreeIds.parse_tree_id(t);return"/repositories/"+this.repo_id+"/"+e.type+"s/"+e.id},t.TreeSync=e}(window);